[460. LFU Cache](https://leetcode.com/problems/lfu-cache/)

* Hash Table, LinkedList, Doubly-Linked List, Design
* Amazon, Microsoft, Google, Coupang, Zomato, KLA, Uber, Citadel, Apple, Oracle, Saleforce, Meta, TikTok
* Similar Questions:
  * [146. LRU Cache](https://leetcode.com/problems/lru-cache/)
  

## Method 1. Node implements Comparable<Node>
```java
class LFUCache {
    // ç¼“å­˜å®¹é‡ï¼Œæ—¶é—´æˆ³
    int capacity, time;
    Map<Integer, Node> key_table;
    TreeSet<Node> S;

    public LFUCache(int capacity) {
        this.capacity = capacity;
        this.time = 0;
        key_table = new HashMap<Integer, Node>();
        S = new TreeSet<Node>();
    }
    
    public int get(int key) {
        if (capacity == 0) {
            return -1;
        }
        // å¦‚æœå“ˆå¸Œè¡¨ä¸­æ²¡æœ‰é”® keyï¼Œè¿”å› -1
        if (!key_table.containsKey(key)) {
            return -1;
        }
        // ä»å“ˆå¸Œè¡¨ä¸­å¾—åˆ°æ—§çš„ç¼“å­˜
        Node cache = key_table.get(key);
        // ä»å¹³è¡¡äºŒå‰æ ‘ä¸­åˆ é™¤æ—§çš„ç¼“å­˜
        S.remove(cache);
        // å°†æ—§ç¼“å­˜æ›´æ–°
        cache.cnt += 1;
        cache.time = ++time;
        // å°†æ–°ç¼“å­˜é‡æ–°æ”¾å…¥å“ˆå¸Œè¡¨å’Œå¹³è¡¡äºŒå‰æ ‘ä¸­
        S.add(cache);
        key_table.put(key, cache);
        return cache.value;
    }
    
    public void put(int key, int value) {
        if (capacity == 0) {
            return;
        }
        if (!key_table.containsKey(key)) {
            // å¦‚æœåˆ°è¾¾ç¼“å­˜å®¹é‡ä¸Šé™
            if (key_table.size() == capacity) {
                // ä»å“ˆå¸Œè¡¨å’Œå¹³è¡¡äºŒå‰æ ‘ä¸­åˆ é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ç¼“å­˜
                key_table.remove(S.first().key);
                S.remove(S.first());
            }
            // åˆ›å»ºæ–°çš„ç¼“å­˜
            Node cache = new Node(1, ++time, key, value);
            // å°†æ–°ç¼“å­˜æ”¾å…¥å“ˆå¸Œè¡¨å’Œå¹³è¡¡äºŒå‰æ ‘ä¸­
            key_table.put(key, cache);
            S.add(cache);
        } else {
            // è¿™é‡Œå’Œ get() å‡½æ•°ç±»ä¼¼
            Node cache = key_table.get(key);
            S.remove(cache);
            cache.cnt += 1;
            cache.time = ++time;
            cache.value = value;
            S.add(cache);
            key_table.put(key, cache);
        }
    }
}

class Node implements Comparable<Node> {
    int cnt, time, key, value;

    Node(int cnt, int time, int key, int value) {
        this.cnt = cnt;     // cnt è¡¨ç¤ºç¼“å­˜ä½¿ç”¨çš„é¢‘ç‡
        this.time = time;   // time è¡¨ç¤ºç¼“å­˜çš„ä½¿ç”¨æ—¶é—´
        this.key = key;
        this.value = value;
    }

    public boolean equals(Object anObject) {
        if (this == anObject) {
            return true;
        }
        if (anObject instanceof Node) {
            Node rhs = (Node) anObject;
            return this.cnt == rhs.cnt && this.time == rhs.time;
        }
        return false;
    }

    public int compareTo(Node rhs) {
        return cnt == rhs.cnt ? time - rhs.time : cnt - rhs.cnt;
    }

    public int hashCode() {
        return cnt * 1000000007 + time;
    }
}
```
**å¤æ‚åº¦åˆ†æ:**
* æ—¶é—´å¤æ‚åº¦ï¼šget æ—¶é—´å¤æ‚åº¦ `O(logn)`ï¼Œput æ—¶é—´å¤æ‚åº¦ `O(logn)`ï¼Œæ“ä½œçš„æ—¶é—´å¤æ‚åº¦ç“¶é¢ˆåœ¨äºå¹³è¡¡äºŒå‰æ ‘çš„æ’å…¥åˆ é™¤å‡éœ€è¦ `O(logn)` çš„æ—¶é—´ã€‚
* ç©ºé—´å¤æ‚åº¦ï¼š`O(capacity)`ï¼Œå…¶ä¸­ capacity ä¸º LFU çš„ç¼“å­˜å®¹é‡ã€‚å“ˆå¸Œè¡¨å’Œå¹³è¡¡äºŒå‰æ ‘ä¸ä¼šå­˜æ”¾è¶…è¿‡ç¼“å­˜å®¹é‡çš„é”®å€¼å¯¹ã€‚


## Reference
* LeetCodeCN: https://leetcode.cn/problems/lfu-cache/solutions/186348/lfuhuan-cun-by-leetcode-solution/
* ğŸŸ©ğŸŒŸ LeetCodeCN: https://leetcode.cn/problems/lfu-cache/solutions/48636/java-13ms-shuang-100-shuang-xiang-lian-biao-duo-ji/