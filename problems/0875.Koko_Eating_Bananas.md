[875. Koko Eating Bananas](https://leetcode.com/problems/koko-eating-bananas/)

* Facebook
* Binary Search
* Similar Questions:
    * Minimize Max Distance to Gas Station
    

## Method 1. Binary Search
`total += (p+m-1) / m` equal to `total += Math.ceil(p/m)`

```java 
class Solution {
    public int minEatingSpeed(int[] piles, int H) {
        int l = 1;
        int r = 1000000000;
        while(l < r) {
            int mid = l + (r - l) / 2;
            int cnt = 0;
            for(int p: piles) {
                cnt += (p + mid - 1) / mid;   // round up
            }
            if(cnt > H) { // mid is too small
                l = mid + 1;
            } else {
                r = mid;
            }
        }   // after the while loop, l == r
        return l;
    }
}
```


## Binary Search (`lo <= hi`)
æ¨¡æ¿ä¸€ï¼Œæ‰¾æœ‰åºæ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªç›®æ ‡å€¼ã€‚æ³¨æ„ right æŒ‡é’ˆä¸€å¼€å§‹å®šä¹‰æ˜¯åœ¨æ•°ç»„ä¸‹æ ‡èŒƒå›´å†…çš„ï¼Œæ‰€ä»¥ while çš„æ¡ä»¶æ‰èƒ½å†™æˆ <=ã€‚[äºŒåˆ†æ³•æ¨¡æ¿](../docs/Binary_Search.md)

**âœ…åˆ†æž:** `lo < hi`
1. ðŸŽ¯ç›®æ ‡: æ‰¾æœ‰åºæ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªç›®æ ‡å€¼ï¼Œæ»¡è¶³`getHours(piles, ?) < h`, `?`å³ä¸ºè¦æ‰¾çš„ç›®æ ‡å€¼
2. äºŒåˆ†æŸ¥æ‰¾çš„æœ€åŸºç¡€å’Œæœ€åŸºæœ¬çš„å½¢å¼ã€‚
3. âœ…æŸ¥æ‰¾æ¡ä»¶å¯ä»¥åœ¨ä¸ä¸Žå…ƒç´ çš„ä¸¤ä¾§è¿›è¡Œæ¯”è¾ƒçš„æƒ…å†µä¸‹ç¡®å®šï¼ˆæˆ–ä½¿ç”¨å®ƒå‘¨å›´çš„ç‰¹å®šå…ƒç´ ï¼‰ã€‚
  * åœ¨æœ¬é¢˜ä¸­æ˜¯ä¸Žç»™å®šçš„æ—¶é—´`h`ç›¸æ¯”è¾ƒï¼Œæ‰€ä»¥ä¸éœ€è¦ä¸Žå·¦å³é‚»å±…æ¯”è¾ƒã€‚
4. ä¸éœ€è¦åŽå¤„ç†ï¼Œå› ä¸ºæ¯ä¸€æ­¥ä¸­ï¼Œä½ éƒ½åœ¨æ£€æŸ¥æ˜¯å¦æ‰¾åˆ°äº†å…ƒç´ ã€‚å¦‚æžœåˆ°è¾¾æœ«å°¾ï¼Œåˆ™çŸ¥é“æœªæ‰¾åˆ°è¯¥å…ƒç´ ã€‚
  * while-loopç»“æŸçš„æ¡ä»¶ä¸º`lo == hi`ï¼Œæ— è®º`lo`, è¿˜æ˜¯`hi`éƒ½æ˜¯æœ€ç»ˆçš„ç»“æžœã€‚

```java
class Solution {
    public int minEatingSpeed(int[] piles, int h) {
        int lo = 1;
        int hi = (int) Math.pow(10, 9);
        while(lo <= hi) {
            int mid = lo + (hi - lo) / 2;
            long hours = getHours(piles, mid);
            // å¦‚æžœè€—æ—¶å¤ªå¤šï¼Œè¯´æ˜Žé€Ÿåº¦å¤ªæ…¢ï¼Œéœ€è¦ç§»åŠ¨å·¦æŒ‡é’ˆ, åä¹‹ç§»åŠ¨å³æŒ‡é’ˆ
            if(hours > h) {
                lo = mid + 1;
            } else {
                hi = mid - 1;
            }
        }
        return lo;
    }

    private long getHours(int[] piles, int speed) {
        long hours = 0;
        for(int pile: piles) {
            hours += pile / speed;
            if(pile % speed != 0) {
                hours += 1;
            }
        }
        return hours;
    }
}
```
**Complexity Analysis:**
Let `n` be the length of the input array `piles` and `m` be the maximum number of bananas in a single pile from `piles`.
1. Time complexity: `O(nâ‹…log m)`
  * The initial search space is from `1` to `m`, it takes `log m` comparisons to reduce the search space to 1.
  * For each eating speed `middle`, we traverse the array and calculate the overall time Koko spends, which takes `O(n)` for each traversal.
  * To sum up, the time complexity is `O(nâ‹…log m)`.
2. Space complexity: `O(1)`
  * For each eating speed `middle`, we iterate over the array and calculate the total hours Koko spends, which costs constant space.
  * Therefore, the overall space complexity is `O(1)`.


## è®¡ç®—åƒé¦™è•‰æ—¶é—´`getHours()`
è®¡ç®—åƒé¦™è•‰æ—¶é—´çš„å‡½æ•°`getHours()`
* åœ¨è¿™ä¸ªè®¡ç®—æ—¶é—´çš„å‡½æ•°é‡Œï¼Œå¯¹äºŽæŸä¸€å †é¦™è•‰ï¼Œå¦‚æžœ`é¦™è•‰æ•° % é€Ÿåº¦ != 0`ï¼Œé‚£ä¹ˆæ„å‘³ç€æ—¶é—´éœ€è¦ + 1ã€‚ä¾‹å­ï¼Œæ¯”å¦‚åƒçš„é€Ÿåº¦æ˜¯ 3ï¼Œä½†æ˜¯é¦™è•‰æœ‰ 10 ä¸ªï¼Œé‚£ä¹ˆå°±å¿…é¡»åˆ† 4 ä¸ªå°æ—¶åƒå®Œã€‚
* **âš ï¸æ³¨æ„:** `long getHours()`è¿”å›žå€¼ç±»åž‹è¦æ˜¯`long`ç±»åž‹ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºçŽ°æº¢å‡ºé—®é¢˜ã€‚æ¯”å¦‚ï¼Œ`piles=[805306368,805306368,805306368], speed=1`, then `hours=805306368/1*3=2415919104 > Integer.MAX_VALUE=2147483647 (2.147*10^9)`


## Reference
* [CNoodle: [LeetCode] 875. Koko Eating Bananas](https://www.cnblogs.com/cnoodle/p/13637439.html)